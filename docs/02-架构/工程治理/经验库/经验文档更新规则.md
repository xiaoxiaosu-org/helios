# 经验文档更新规则（经验库治理）

> 版本：v1.0
> 最近更新：2026-02-27
> 适用范围：`docs/02-架构/工程治理/经验库/` 全部经验文档
> 对应实现：`scripts/docs/index-check.sh`、`scripts/docs/git-governance-sync-check.sh`、`scripts/ci/verify.sh`

适用范围：`docs/02-架构/工程治理/经验库/` 下所有经验性质文档。

## 1. 更新触发条件（命中任一即必须更新）

1. Git 门禁、Hook、提交模板、PR 模板有任何规则变化。
2. CI 工作流新增/删除/重命名关键检查项。
3. 文档分层原则、ADR/HOTFIX 触发逻辑、DoD 标准发生变化。
4. 新增可复用的初始化脚本、验证入口或失败复盘模式。
5. 发现经验文档中的命令已失效或与当前仓库事实不一致。

## 2. 时效要求（SLA）

1. 常规变更：相关规则合入后 `24` 小时内完成经验库更新。
2. 高风险变更（安全、主干保护、提交规范）：`当日`完成更新。
3. Hotfix 场景：允许先用 `HOTFIX-*` 记录，`48` 小时内补齐经验文档。

## 3. 更新责任人

1. 直接修改门禁/治理实现的人，默认是第一责任人。
2. PR 合并人负责二次确认“经验库是否同步更新”。
3. 架构 Owner 对经验库内容一致性负最终审核责任。

## 4. 更新内容最小要求

每次更新必须同时包含：

1. 事实变更：具体改了什么（脚本、工作流、模板、规则）。
2. 操作变更：命令怎么执行，输入输出是什么。
3. 风险提示：哪些行为会失败，如何快速回滚或补救。
4. 生效日期：明确到自然日（例如 `2026-02-27`）。

## 5. 文档内版本头规范（强制）

经验文档顶部建议增加以下字段；如缺失，更新时需补齐：

```md
> 版本：vX.Y
> 最近更新：YYYY-MM-DD
> 适用范围：<项目阶段/技术栈>
> 对应实现：<脚本/工作流路径>
```

## 6. 与实现的一致性校验（提交前必须执行）

```bash
scripts/docs/index-check.sh
scripts/docs/git-governance-sync-check.sh
scripts/ci/verify.sh
```

若本次只改经验文档，也应至少执行前两项，并在提交说明写清楚验证结果。

## 7. 审查清单（PR 勾选）

1. 文档中的命令已在当前仓库手动执行过。
2. 文档引用路径存在且可打开。
3. 与 `AGENTS.md`、`工程治理与门禁.md`、`Git门禁与模板对照清单.md` 无冲突。
4. 涉及 Git 规则变化时，已同步说明本地配置与远端保护配置。
5. 文档使用中文描述（关键段落必须中文）。

## 8. 过期清理规则

1. 每月最后一周做一次经验库回顾，删除或标记过期命令。
2. 超过 `90` 天未校验的命令块，标记为“待复核”。
3. 被新文档替代的旧文档必须在开头写“已被 XXX 替代”并给出链接。
