# PLAN-20260227-01：工程智能化路线图（唯一执行计划）

## 背景与目标

- 背景：工程治理已经具备基础门禁，但计划推进、追踪与执行模型此前存在 TD/CAP 双口径并行。
- 目标：以 `PLAN-20260227-01` 作为本专题唯一执行计划，统一使用 `WI-PLAN2026022701-NN` 编号。
- 非目标：本计划不替代业务功能路线图，不管理业务需求优先级。

## WorkItem 清单

状态枚举：`todo` / `in_progress` / `blocked` / `done`

| WorkItem | legacy 别名 | 类型 | 标题 | Owner | 状态 | 验收命令 | 证据目录 |
|---|---|---|---|---|---|---|---|
| WI-PLAN2026022701-01 | CAP-001 | capability | 可运行的任务沙盒（每任务隔离） | repo-owner | done | `scripts/cap/verify.sh CAP-001` | `artifacts/CAP-001/` |
| WI-PLAN2026022701-02 | CAP-002 | capability | Agent 驱动的 UI 验证（浏览器自动化） | repo-owner | done | `scripts/cap/verify.sh CAP-002` | `artifacts/CAP-002/` |
| WI-PLAN2026022701-03 | CAP-003 | capability | 可查询的可观测性闭环（logs/metrics/traces） | repo-owner | done | `scripts/cap/verify.sh CAP-003` | `artifacts/CAP-003/` |
| WI-PLAN2026022701-04 | CAP-004 | capability | 架构边界/依赖方向结构化约束 | repo-owner | done | `scripts/cap/verify.sh CAP-004` | `artifacts/CAP-004/` |
| WI-PLAN2026022701-05 | CAP-005 | capability | 结构化日志规范自动校验 | repo-owner | done | `scripts/cap/verify.sh CAP-005` | `artifacts/CAP-005/` |
| WI-PLAN2026022701-06 | CAP-006 | capability | 质量评分与预算 | repo-owner | done | `scripts/cap/verify.sh CAP-006` | `artifacts/CAP-006/` |
| WI-PLAN2026022701-07 | CAP-007 | capability | 技术债追踪 | repo-owner | done | `scripts/cap/verify.sh CAP-007` | `artifacts/CAP-007/` |
| WI-PLAN2026022701-08 | CAP-008 | capability | Doc-gardening | repo-owner | done | `scripts/cap/verify.sh CAP-008` | `artifacts/CAP-008/` |
| WI-PLAN2026022701-09 | CAP-009 | capability | PR 闭环自动化 | repo-owner | done | `scripts/cap/verify.sh CAP-009` | `artifacts/CAP-009/` |
| WI-PLAN2026022701-10 | CAP-010 | capability | PR 校验鲁棒性 | repo-owner | done | `scripts/cap/verify.sh CAP-010` | `artifacts/CAP-010/` |
| WI-PLAN2026022701-11 | TD-001 | debt | 工程智能化能力缺口落地 | repo-owner | in_progress | `scripts/workflow/run.sh WI-PLAN2026022701-11 progress` | `artifacts/workflow/` |
| WI-PLAN2026022701-12 | TD-002 | debt | 技术债清单状态自动校验不足 | repo-owner | done | `scripts/workflow/run.sh WI-PLAN2026022701-12 close` | `artifacts/workflow/` |

## 推进记录

| 日期 | WorkItem | 动作 | 结果 | 备注 |
|---|---|---|---|---|
| 2026-02-28 | WI-PLAN2026022701-01 ~ WI-PLAN2026022701-10 | 批量能力验收 | pass | CAP 最小能力全量落地 |
| 2026-02-28 | WI-PLAN2026022701-12 | 技术债治理门禁闭环 | pass | 技术债校验进入持续门禁 |
| 2026-02-28 | WI-PLAN2026022701-11 | 持续化治理校验 | in_progress | 进入业务化深化阶段 |

## 验收与证据

- 统一验收入口：`scripts/workflow/run.sh <WI-PLANYYYYMMDDNN-NN> [start|progress|close|full]`
- 统一门禁入口：`scripts/ci/verify.sh`
- 统一证据目录：`artifacts/CAP-*/`、`artifacts/workflow/`
- 统一追踪日志：`artifacts/workflow/events/WI-PLAN2026022701-*.jsonl`

## 风险与阻塞

- 风险：能力项均已 done，但主债项 `WI-PLAN2026022701-11` 仍在持续推进，说明“机制可用”与“业务收益兑现”仍有时间差。
- 风险：后续若新增计划未复用统一模板，可能再次出现编号漂移与推进口径不一致。
- 阻塞：暂无硬阻塞。

## 下一步

1. 按 `WI-PLAN*-**` 规则新增后续治理项，禁止再引入平行编号体系。
2. 将推进证据统一沉淀到 WorkItem 事件流，确保每项任务可回放。
3. 持续以 `scripts/ci/verify.sh` + `scripts/workflow/backlog.sh check` 作为提交前强制校验。

## 能力缺口清单（Legacy 验收对照）

状态枚举：`Planned` / `In Progress` / `Blocked` / `Done`

| ID | 能力 | 当前缺口（摘要） | 交付物（可执行/可验证） | 门禁/验收（DoD） | 状态 |
|---|---|---|---|---|---|
| CAP-001 | 可运行的任务沙盒（每任务隔离） | 已落地最小沙盒创建/销毁与 smoke 验收 | `scripts/dev/sandbox-create.sh`（或等价）+ 文档说明放 `docs/07-运行态/` | CI 可选；本地脚本可重复运行并能清理 | Done |
| CAP-002 | Agent 驱动的 UI 验证（浏览器自动化） | 已落地最小 UI smoke 验证入口与产物归档 | `scripts/e2e/run-ui-check.sh` 产出截图/录屏到固定目录 | 失败时产物可用于复盘；成功可复现 | Done |
| CAP-003 | 可查询的可观测性闭环（logs/metrics/traces） | 已落地最小 trace 生成/查询脚本与查询剧本 | `docs/07-运行态/` 新增“查询剧本”+ 示例查询 + 最小字段规范 | 任意关键链路能按 `traceId` 追到结果与耗时 | Done |
| CAP-004 | 架构边界/依赖方向的结构化约束（taste invariants） | 缺少可机械校验的“目录/模块依赖规则” | `scripts/ci/arch-check.sh` + 规则文件（例如 `docs/02-架构/边界与依赖规则.md`） | CI 硬门禁：违规则阻断且报错提供修复指令 | Done |
| CAP-005 | 结构化日志规范自动校验 | 已落地最小结构化日志校验（无上下文字符串日志拦截） | `scripts/ci/logging-check.sh`（按语言栈逐步启用） | CI 报错必须指向“应该使用的 logger/字段” | Done |
| CAP-006 | 质量评分与预算（QUALITY_SCORE / 可靠性预算） | 已落地自动汇总与同步校验机制 | `docs/02-架构/质量评分与演进.md`（评分维度+目标+现状） | 每个里程碑更新一次评分与差距 | Done |
| CAP-007 | 技术债追踪（tech debt tracker） | 缺少统一技术债清单与偿还机制 | `docs/02-架构/技术债清单.md`（带 ID/优先级/验收） | 每次计划评审更新状态；完成项移入 completed | Done |
| CAP-008 | Doc-gardening（周期性熵控制） | 已落地定时扫描与报告产物机制 | GitHub scheduled workflow + `scripts/docs/gardening.sh` | 每周自动出报告或 PR；可快速审阅合并 | Done |
| CAP-009 | PR 闭环自动化（从失败到修复指路） | 缺少 PR 模板、失败指路一致性、修复剧本入口 | `.github/pull_request_template.md` + CI 报错信息标准化 | PR 默认携带 DoD；失败信息带下一步命令 | Done |
| CAP-010 | PR 校验鲁棒性（门禁自测 + push diff 回退） | 门禁存在“脚本可执行但规则失效”与 force-push 后 push 检查误失败风险 | `scripts/ci/gate-selftest.sh` + workflow diff fallback（`doc-check`/`quality-gates`） | CI 强制执行门禁自测；before SHA 不可达时仍可完成校验 | Done |
