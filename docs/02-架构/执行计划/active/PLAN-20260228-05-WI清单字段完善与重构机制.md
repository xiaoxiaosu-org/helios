# PLAN-20260228-05：WI清单字段完善与重构机制

## 背景与目标

- 背景：现有 WorkItem 已形成统一编号与执行入口，但字段语义、必填约束、迁移流程仍依赖人工经验，跨计划易出现口径漂移。
- 问题：清单字段缺少稳定基线与可回归机制，重构时容易出现“字段新增/删除无门禁、批量迁移不可回放”的治理风险。
- 目标：完善 WI 清单字段规范，建立“规则定义 -> 自动校验 -> 分批重构 -> 结果验收”的完整机制，并纳入持续门禁。
- 非目标：不改动业务功能优先级，不引入新的并行计划编号体系。

## WorkItem 清单

状态枚举：`todo` / `in_progress` / `blocked` / `done`

| WorkItem | 类型 | 标题 | Owner | 状态 | 验收命令 | 证据目录 |
|---|---|---|---|---|---|---|
| WI-PLAN2026022805-01 | initiative | 计划初始化（待拆解） | repo-owner | todo | `scripts/workflow/run.sh WI-PLAN2026022805-01 progress` | `artifacts/workflow/` |
| WI-PLAN2026022805-02 | task | 定义WI清单字段基线与约束矩阵 | repo-owner | todo | `scripts/workflow/backlog.sh check` + `scripts/ci/plan-template-check.sh` | `artifacts/workflow/` |
| WI-PLAN2026022805-03 | task | 实现WI字段一致性校验与规范化机制 | repo-owner | todo | `scripts/workflow/backlog.sh check` + `scripts/ci/verify.sh` | `artifacts/workflow/` |
| WI-PLAN2026022805-04 | task | 建立WI重构执行机制（分批迁移/回滚/验收） | repo-owner | todo | `scripts/ci/verify.sh` + `scripts/docs/git-governance-sync-check.sh` | `artifacts/workflow/` |
| WI-PLAN2026022805-05 | debt | 完成WI整体重构收口与长期治理 | repo-owner | todo | `scripts/ci/verify.sh` + `scripts/workflow/backlog.sh check` + `scripts/ci/plan-template-check.sh` | `artifacts/workflow/` |

## 推进记录

| 日期 | WorkItem | 动作 | 结果 | 备注 |
|---|---|---|---|---|
| 2026-02-28 | WI-PLAN2026022805-01 | 初始化计划 | pass | 自动创建首个 WorkItem |
| 2026-02-28 | WI-PLAN2026022805-02 ~ WI-PLAN2026022805-05 | 补齐可执行拆解 | pass | 形成“字段基线 -> 校验机制 -> 重构机制 -> 收口治理”链路 |

## 字段清单完善范围

| 字段域 | 关键字段 | 约束方向 |
|---|---|---|
| 身份域 | `workItemId` / `planId` / `kind` | 主键格式、归属唯一、类型枚举固定 |
| 状态域 | `status` / `priority` / `lastUpdate` | 状态枚举、优先级格式、日期可解析 |
| 依赖域 | `links.dependsOnWorkItems` | 依赖存在性、循环依赖防护（重构期重点巡检） |
| 执行域 | `workflow.triggerPaths` / `requiredDocs` / `acceptanceCmds` / `closeChecks` | 触发-文档联动、验收可执行、闭环条件明确 |
| 追踪域 | `tracking.eventsFile` | 事件文件路径规范化、可追溯 |

## 验收与证据

- 统一验收入口：`scripts/workflow/run.sh <WI-PLANYYYYMMDDNN-NN> [start|progress|close|full]`
- 统一证据目录：`artifacts/workflow/<WI-ID>/<run-id>/`
- 事件追踪文件：`artifacts/workflow/events/<WI-ID>.jsonl`

## 风险与阻塞

- 风险：
- 阻塞：
- 解除阻塞动作：

## 下一步

1. 启动 `WI-PLAN2026022805-02`，完成字段基线与约束矩阵定义并回填治理文档。
2. 启动 `WI-PLAN2026022805-03`，将字段一致性校验固化到 backlog 规范化与 CI。
3. 启动 `WI-PLAN2026022805-04`，落地分批迁移、回滚与验收机制。
4. 启动 `WI-PLAN2026022805-05`，完成全量收口并形成持续治理节奏。
