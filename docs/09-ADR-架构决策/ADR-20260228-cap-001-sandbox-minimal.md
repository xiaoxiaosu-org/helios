# ADR-20260228: CAP-001 任务沙盒最小可验收实现

## 状态
Accepted

## 日期
2026-02-28

## 背景
- TD-001 推进过程中，`scripts/cap/verify.sh CAP-001` 因缺少 `sandbox-create.sh` 与 `sandbox-destroy.sh` 持续阻塞。
- 路线图对 CAP-001 的 DoD 要求是“脚本可执行 + `--smoke --out` 可通过 + 产物完整”。
- 现阶段业务代码尚未引入真实隔离运行器，需要先提供可机械验证的最小实现作为基线。

## 决策
- 新增 `scripts/dev/sandbox-create.sh` 与 `scripts/dev/sandbox-destroy.sh`，提供 CAP-001 最小能力：
  - 创建临时沙盒目录并输出 `sandbox.env`
  - 清理沙盒目录并输出 `cleanup.log`
- 销毁脚本加入路径白名单保护，仅允许删除 `/tmp/helios-sandbox-` 前缀目录。
- 在 `docs/07-运行态/` 新增《任务沙盒最小实现》文档，说明产物字段与安全约束。

## 影响

### 正面影响
- CAP-001 验收从 blocked 转为 pass，TD-001 可继续推进。
- 形成可复用的沙盒证据产物格式，为后续真实隔离实现提供兼容接口。

### 负面影响
- 当前实现是最小 smoke 版本，不包含容器/命名空间等强隔离机制。
- 后续引入真实执行环境时需要补充迁移与兼容说明。

## 备选方案
- 等待完整沙盒架构一次性落地：拒绝，无法解除当前 CAP-001 阻塞。
- 在验收脚本中放宽检查：拒绝，削弱 CAP 验收可信度。

## 版本影响
- 是否影响 API：否
- 是否影响事件模型：否
- 是否影响数据结构：否
