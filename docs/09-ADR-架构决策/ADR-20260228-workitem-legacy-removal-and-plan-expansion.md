# ADR-20260228-workitem-legacy-removal-and-plan-expansion: WorkItem 执行口径收敛与计划体系扩展

## 状态
- 已采纳

---

## 背景

执行计划已切换到 `WI-PLAN*` 模型，但流程中仍存在 `legacyId` 执行痕迹，且近期新增治理诉求（技术债并入、经验库治理、WI 重构、质量评分演进、Harness 能力对齐）尚未全部纳入同一执行主链路。

---

## 决策

1. 执行入口统一以 `workItemId` 为唯一主键，移除 `legacyId` 在 `start/close/workitem-add` 的执行依赖。  
2. ADR 闭环校验由“按 legacy 映射”改为“按 `workItemId` 关联”。  
3. 计划模板与历史计划文档结构统一，禁止继续在 WorkItem 表格中维护失效 `legacy` 列。  
4. 将新增治理诉求全部落到 active 计划与 `backlog.yaml`，每项均具备依赖、触发路径、必需文档、验收命令与收口项。

---

## 影响

### 正面影响
- 执行口径单一，减少历史兼容字段造成的闭环歧义。
- 新增治理能力不再停留在文档层，进入可执行、可验证、可追踪状态。
- `workflow-sync` 与模板门禁对齐后，计划文档与执行主源一致性提升。

### 负面影响
- 短期内计划数量与 WorkItem 数量增加，治理成本上升。
- 触发路径粒度需要持续调优，否则可能出现误触发或漏触发。

---

## 替代方案

- 保留 `legacyId` 作为执行兼容键：短期改造小，但会继续放大双口径维护成本，未采用。  
- 仅补文档不改脚本：实现快，但无法形成可执行闭环，未采用。

---

## 版本影响

- 是否影响 API：否
- 是否影响事件模型：否
- 是否影响数据结构：是（`backlog.yaml` WorkItem 执行语义与字段约束收敛）
